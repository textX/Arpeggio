<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Igor DejanoviÄ‡">
  
  <title>Troubleshooting - Arpeggio</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Troubleshooting";
    var mkdocs_page_input_path = "troubleshooting.md";
    var mkdocs_page_url = "/troubleshooting/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68681917-1', 'igordejanovic.net');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Arpeggio</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>User Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting_started/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../grammars/">Grammars</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../parse_trees/">Parse tree</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../handling_errors/">Handling errors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../debugging/">Debugging</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../configuration/">Parser configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../semantics/">Semantic analysis</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Troubleshooting</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#troubleshooting-guide">Troubleshooting Guide</a></li>
                
                    <li><a class="toctree-l4" href="#left-recursion-and-recursionerror">Left recursion and RecursionError</a></li>
                
                    <li><a class="toctree-l4" href="#unrecognized-grammar-element">Unrecognized grammar element '...'</a></li>
                
                    <li><a class="toctree-l4" href="#visitor-method-is-not-called-during-semantic-analysis">Visitor method is not called during semantic analysis</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorials</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tutorials/csv/">CSV</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tutorials/bibtex/">BibTex</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tutorials/calc/">Calc</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>About</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../about/discuss/">Discuss</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../about/contributing/">Contributing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../about/license/">License</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Arpeggio</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>User Guide &raquo;</li>
        
      
    
    <li>Troubleshooting</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/igordejanovic/Arpeggio" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="troubleshooting-guide">Troubleshooting Guide</h1>
<p>Common problems and mistakes</p>
<hr />
<h2 id="left-recursion-and-recursionerror">Left recursion and RecursionError</h2>
<p>If you get <code>RecursionError: maximum recursion depth exceeded while calling a
Python object</code> it is a good indication that you have a <a href="https://en.wikipedia.org/wiki/Left_recursion">left
recursion</a> in the grammar.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Arpeggio parser will implement a support for detecting and reporting of left
recursions in the grammar. See <a href="https://github.com/igordejanovic/Arpeggio/issues/23">issue
23</a></p>
</div>
<p>A left recursion is found if the parser calls the same rule again while no
characters from the input is consumed from the previous call (e.g. we have the
same state). This will lead to the same sequence of events and we have infinite
loop.</p>
<p>For example, lets suppose that we want to match following string:</p>
<pre><code>b a a a a a a
</code></pre>
<p>We could write a grammar like this:</p>
<pre><code>A = A 'a' / 'b'
</code></pre>
<p>But this grammar is left-recursive and the recursive-descent top-down parser
like Arpeggio will try to loop indefinitely trying to match <code>A</code> over and over
again in the same spot of the input string.</p>
<p>Although, there are techniques to handle left-recursion in top-down parsers
automatically, Arpeggio does not implements them and a classic approach of
<a href="https://en.wikipedia.org/wiki/Left_recursion#Removing_left_recursion">removing left
recursion</a>
must be used.</p>
<p>To remove left recursion from the above grammar we do the following:</p>
<pre><code>A = 'b' 'a'*
</code></pre>
<p>Or, get all non-left recursive choices and put them first (<code>b</code> in this case) and
than add the zero-or-more repetition of the recursive part without the left
recursive non-terminal (<code>a</code> from <code>A 'a'</code> in this case).</p>
<p>Another example:</p>
<pre><code>add = mult / add '+' mult / add '-' mult
</code></pre>
<p>becomes:</p>
<pre><code>add = mult (('+' mult) / ('-' mult))*
</code></pre>
<p>or:</p>
<pre><code>add = mult (('+' / '-') mult)*
</code></pre>
<p>In general:</p>
<pre><code>A = A a1 / A a2 / ... / A an / b1 / b2 / ... / bm
</code></pre>
<p>where uppercase letters represents non-terminals whereas lowercase letters
represent terminals.</p>
<p>Removing left recursion yields:</p>
<pre><code>A = (b1 / b2 / ... / bm) (a1 / a2 / ... / an)*
</code></pre>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Be aware that the parse tree will not be the same.</p>
</div>
<h2 id="unrecognized-grammar-element">Unrecognized grammar element '...'</h2>
<p>This might happen when non-unicode literals are used. Make sure that you use
unicode literals when defining grammars using Python notation.</p>
<p>You might want to include:</p>
<pre><code class="python">from __future__ import unicode_literals
</code></pre>

<p>This will enable unicode literals in the python &lt; 3.</p>
<h2 id="visitor-method-is-not-called-during-semantic-analysis">Visitor method is not called during semantic analysis</h2>
<p>Semantic analysis operates on a parse tree nodes produced by grammar rules.
If you are using a <code>reduce_tree=True</code> option in the construction of the parser
all non-terminal nodes with only one child will be suppressed in the parse tree.
Thus, visitor methods for those nodes will not be called.</p>
<p>To resolve issue either disable tree reduction during parser construction (i.e.
<code>reduce_tree=False</code>) or do visitor job in some of the calling rules that produce
parse tree node with more than one child.</p>
<p>As a side note, there is implicit reduction of nodes whose grammar rule is a 
sequence with only one child.</p>
<pre><code class="python">def mean():             return number
def number():           return _(r'\d*\.\d*|\d+')
</code></pre>

<p>Here a node <code>number</code> will be suppressed from the parser model and visitor
<code>visit_number</code> will not be called. You have to define <code>visit_mean</code> or a visitor
for some of the rules calling <code>mean</code>.</p>
<p>This implicit reduction can not be disabled at the moment. Please see <a href="https://github.com/igordejanovic/Arpeggio/issues/24">issue
24</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tutorials/csv/" class="btn btn-neutral float-right" title="CSV">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../semantics/" class="btn btn-neutral" title="Semantic analysis"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/igordejanovic/Arpeggio" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../semantics/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../tutorials/csv/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
