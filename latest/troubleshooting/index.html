<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Igor Dejanović" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Troubleshooting - Arpeggio</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/version-select.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Troubleshooting";
        var mkdocs_page_input_path = "troubleshooting.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-68681917-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', "UA-68681917-1");
      </script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Arpeggio
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../grammars/">Grammars</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parse_trees/">Parse tree</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../handling_errors/">Handling errors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../debugging/">Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../configuration/">Parser configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../semantics/">Semantic analysis</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Troubleshooting</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#left-recursion-and-recursionerror">Left recursion and RecursionError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#unrecognized-grammar-element">Unrecognized grammar element '...'</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#visitor-method-is-not-called-during-semantic-analysis">Visitor method is not called during semantic analysis</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/csv/">CSV</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/bibtex/">BibTex</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/calc/">Calc</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../about/discuss/">Discuss</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../about/contributing/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../about/license/">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Arpeggio</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">User Guide</li>
      <li class="breadcrumb-item active">Troubleshooting</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/textX/Arpeggio/edit/master/docs/troubleshooting.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="troubleshooting-guide">Troubleshooting Guide<a class="headerlink" href="#troubleshooting-guide" title="Permanent link">&para;</a></h1>
<p>Common problems and mistakes</p>
<hr />
<h2 id="left-recursion-and-recursionerror">Left recursion and RecursionError<a class="headerlink" href="#left-recursion-and-recursionerror" title="Permanent link">&para;</a></h2>
<p>If you get <code>RecursionError: maximum recursion depth exceeded while calling a
Python object</code> it is a good indication that you have a <a href="https://en.wikipedia.org/wiki/Left_recursion">left
recursion</a> in the grammar.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Arpeggio parser will implement a support for detecting and reporting of left
recursions in the grammar. See <a href="https://github.com/textX/Arpeggio/issues/23">issue
23</a></p>
</div>
<p>A left recursion is found if the parser calls the same rule again while no
characters from the input is consumed from the previous call (e.g. we have the
same state). This will lead to the same sequence of events and we have infinite
loop.</p>
<p>For example, lets suppose that we want to match following string:</p>
<pre><code>b a a a a a a
</code></pre>
<p>We could write a grammar like this:</p>
<pre><code>A = A 'a' / 'b'
</code></pre>
<p>But this grammar is left-recursive and the recursive-descent top-down parser
like Arpeggio will try to loop indefinitely trying to match <code>A</code> over and over
again in the same spot of the input string.</p>
<p>Although, there are techniques to handle left-recursion in top-down parsers
automatically, Arpeggio does not implement them and a classic approach of
<a href="https://en.wikipedia.org/wiki/Left_recursion#Removing_left_recursion">removing left
recursion</a>
must be used.</p>
<p>To remove left recursion from the above grammar we do the following:</p>
<pre><code>A = 'b' 'a'*
</code></pre>
<p>Or, get all non-left recursive choices and put them first (<code>b</code> in this case) and
than add the zero-or-more repetition of the recursive part without the left
recursive non-terminal (<code>a</code> from <code>A 'a'</code> in this case).</p>
<p>Another example:</p>
<pre><code>add = mult / add '+' mult / add '-' mult
</code></pre>
<p>becomes:</p>
<pre><code>add = mult (('+' mult) / ('-' mult))*
</code></pre>
<p>or:</p>
<pre><code>add = mult (('+' / '-') mult)*
</code></pre>
<p>In general:</p>
<pre><code>A = A a1 / A a2 / ... / A an / b1 / b2 / ... / bm
</code></pre>
<p>where uppercase letters represents non-terminals whereas lowercase letters
represent terminals.</p>
<p>Removing left recursion yields:</p>
<pre><code>A = (b1 / b2 / ... / bm) (a1 / a2 / ... / an)*
</code></pre>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Be aware that the parse tree will not be the same.</p>
</div>
<h2 id="unrecognized-grammar-element">Unrecognized grammar element '...'<a class="headerlink" href="#unrecognized-grammar-element" title="Permanent link">&para;</a></h2>
<p>This might happen when non-unicode literals are used. Make sure that you use
unicode literals when defining grammars using Python notation.</p>
<p>You might want to include:</p>
<pre><code class="language-python">from __future__ import unicode_literals
</code></pre>
<p>This will enable unicode literals in the python &lt; 3.</p>
<h2 id="visitor-method-is-not-called-during-semantic-analysis">Visitor method is not called during semantic analysis<a class="headerlink" href="#visitor-method-is-not-called-during-semantic-analysis" title="Permanent link">&para;</a></h2>
<p>Semantic analysis operates on a parse tree nodes produced by grammar rules.
If you are using a <code>reduce_tree=True</code> option in the construction of the parser
all non-terminal nodes with only one child will be suppressed in the parse tree.
Thus, visitor methods for those nodes will not be called.</p>
<p>To resolve issue either disable tree reduction during parser construction (i.e.
<code>reduce_tree=False</code>) or do visitor job in some of the calling rules that produce
parse tree node with more than one child.</p>
<p>As a side note, there is implicit reduction of nodes whose grammar rule is a 
sequence with only one child.</p>
<pre><code class="language-python">def mean():             return number
def number():           return _(r'\d*\.\d*|\d+')
</code></pre>
<p>Here a node <code>number</code> will be suppressed from the parser model and visitor
<code>visit_number</code> will not be called. You have to define <code>visit_mean</code> or a visitor
for some of the rules calling <code>mean</code>.</p>
<p>This implicit reduction can not be disabled at the moment. Please see <a href="https://github.com/textX/Arpeggio/issues/24">issue
24</a>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../semantics/" class="btn btn-neutral float-left" title="Semantic analysis"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../tutorials/csv/" class="btn btn-neutral float-right" title="CSV">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; <a href="http://www.igordejanovic.net/">Igor Dejanović</a>.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/textX/Arpeggio" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../semantics/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../tutorials/csv/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../js/version-select.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
